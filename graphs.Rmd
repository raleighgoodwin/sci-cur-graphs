---
title: "graphs"
output: html_document
---
# libraries
```{r}
library(tidyverse)
library(here)
library(rio)
library(ggplot2)
library(Hmisc)
```

# data
## import and clean dataframes
```{r}
# conservative-motivated
arctic_df <- import(here("data", "arctic-ice-data.csv"))
temp_df <- import(here("data", "global-temp-data.txt"))

# liberal-motivated
ozone_df <- import(here("data", "ozone-data.txt")) %>% 
  janitor::clean_names() %>% 
  rename(
    "year" = "v1",
    "area" = "value"
  )

# boundary conditions
co2_df <- import(here("data", "carbon-dioxide-data.txt"))
co2_df <- co2_df[2:nrow(co2_df),] %>% 
  rename(
    "year" = "V1",
    "monthly_avg" = "V4",
    "deseasonalized" = "V5"
  )

icesheets_df <- import(here("data", "ice-sheets-data.txt")) %>% 
  rename(
    "year" = "V1",
    "mass" = "V2",
    "uncertainty" = "V3"
  )
## fix year value
icesheets_df$year <- as.character(icesheets_df$year) %>% 
  strtrim(., 4)
 
# other
sealevel_df <- import(here("data", "sea-level-data.txt"))
```

## create plot dataframes
```{r}
arcticplot_df <- arctic_df %>% 
  select(year, area)

tempplot_df <- temp_df %>% 
  select(Year, No_Smoothing)

ozoneplot_df <- ozone_df %>% 
  select(year, area)

co2plot_df <- co2_df %>% 
  select(year, monthly_avg, deseasonalized)
# annual average
co2plot_df <- co2plot_df %>%
  group_by(year) %>%
  summarise(area = mean(monthly_avg))

icesheetsplot_df <- icesheets_df %>% 
  select(year, mass)
# annual average
icesheetsplot_df <- icesheetsplot_df %>%
  group_by(year) %>%
  summarise(mass = mean(mass)) %>% 
  mutate(year = as.numeric(year))
```

## create jittered plot dataframes
```{r}
# j725_arcticplot_df <- arcticplot_df %>% 
#  mutate(area = jitter(area, amount = .725))

jitteredilikeit <- j725_arcticplot_df
```

# plots
## political plots
### arctic plot
```{r}
arcticplot <- arcticplot_df %>% 
  filter(year >= 1980) %>% 
  ggplot(aes(year, area)) +
  geom_point() +
  geom_line()

arcticplot + 
  labs(x = NULL,
       y = "Amount of Ice (million square kilometers)",
       title = "Average Monthly Amount of Arctic Sea Ice \n1979-2021") +
  theme_bw() +
  theme(
    axis.text.x = element_text(face = "bold",
                               color = "black",
                               size = 10,
                               angle = 45,
                               vjust = .8),
    axis.text.y = element_text(face = "bold",
                               color = "black",
                               size = 10),
    axis.title.y = element_text(face = "bold"),
    plot.title = element_text(face = "bold",
                              hjust = .5)
    ) +
  scale_x_continuous(breaks = seq(1980, 2021, by = 5)) +
  scale_y_continuous(breaks = seq(1, 7, by = .5))
```

```{r}
arcticplot_df$title <- "Average Monthly Amount of Arctic Sea Ice \n1979-2021"

arcticplot <- arcticplot_df %>% 
  filter(year >= 1980) %>% 
  ggplot(aes(year, area)) +
  geom_point(size = 2) +
  geom_line(size = .7)

arcticplot + 
  labs(x = NULL,
       y = "Amount of Ice (million square kilometers)") +
  facet_grid(. ~ title) +
  theme_linedraw() +
  theme(
    axis.text.x = element_text(face = "bold",
                               color = "black",
                               size = 10,
                               angle = 45,
                               vjust = .8),
    axis.text.y = element_text(face = "bold",
                               color = "black",
                               size = 10),
    axis.title.y = element_text(face = "bold"),
    strip.background = element_rect(fill = "black"),
    strip.text = element_text(size = 15,
                              face = "bold",
                              color = "white"),
    axis.ticks = element_line(color = "black"),
    panel.grid.major = element_line(color = "black", size = .3)) +
  scale_x_continuous(breaks = seq(1980, 2021, by = 2)) +
  scale_y_continuous(breaks = seq(1, 7, by = .5))

```


### temp plot
```{r}
tempplot <- tempplot_df %>% 
  filter(Year >= 1980) %>% 
  ggplot(aes(Year, No_Smoothing)) +
  geom_point() +
  geom_line()
  
```

### ozone plot
```{r}
# ozoneplot <- ozoneplot_df %>% 
#   filter(year != 2021) %>% 
#   ggplot(aes(year, area)) +
#   geom_point() +
#   geom_line()

ozoneplot <- ozoneplot_df %>% 
  filter(year >=2000 & year != 2021) %>% 
  ggplot(aes(year, area)) +
  geom_point() +
  geom_line()
  
```

### co2 plot
```{r}
co2plot <- co2plot_df %>% 
  filter(year >= 1980) %>% 
  ggplot(aes(year, area)) +
  geom_point() +
  geom_line()
```

### ice sheets
```{r}
icesheetsplot <- icesheetsplot_df %>% 
  ggplot(aes(year, mass)) +
  geom_point() +
  geom_line()
```

## non-political plots
### arctic jittered plot
```{r}
j725_arcticplot_df %>% 
  ggplot(aes(year, area)) +
  geom_point() +
  geom_line()

arcticplot_df %>% 
  ggplot(aes(year, area)) +
  geom_point() +
  geom_line()
```

### temp jittered plot
```{r}

```

### ozone jittered plot
```{r}

```

### co2 jittered plot
```{r}

```

### ice sheets jittered plot
```{r}

```

